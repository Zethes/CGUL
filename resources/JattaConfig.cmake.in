# - Config file for the Jatta package
# It defines the following variables
#  Jatta_INCLUDE_DIRS                     - include directories for Jatta
#  Jatta_LIBRARIES                        - libraries to link against
#  Jatta_MODULES                          - the necessary modules (recommended: use jatta_copy_modules)
# It defines the following macros
#  jatta_copy_modules(target destination) - copies required modules (dll/so/dylib) to the given directory

get_filename_component(Jatta_INCLUDE_DIRS "${CMAKE_CURRENT_LIST_DIR}/../include" ABSOLUTE)
get_filename_component(Jatta_MODULES "${CMAKE_CURRENT_LIST_DIR}/../lib/@Jatta_MODULE_NAME@" ABSOLUTE)

add_library(Jatta STATIC IMPORTED)
set_target_properties(Jatta PROPERTIES IMPORTED_LOCATION ${Jatta_MODULES})
set(Jatta_LIBRARIES Jatta@SYSTEM_LIBRARIES@)

function(jatta_copy_modules TARGET DESTINATION)
    if(NOT Jatta_MODULES STREQUAL "")
        add_custom_command(TARGET ${TARGET} POST_BUILD COMMAND ${CMAKE_COMMAND} -E copy_if_different "${Jatta_MODULES}" "${DESTINATION}" VERBATIM)
    endif()
endfunction()

function(jatta_bake_rpath TARGET RPATH)
    set_property(TARGET ${TARGET} PROPERTY SKIP_BUILD_RPATH FALSE)
    set_property(TARGET ${TARGET} PROPERTY BUILD_WITH_INSTALL_RPATH TRUE)
    set_property(TARGET ${TARGET} PROPERTY INSTALL_RPATH "${RPATH}")
    set_property(TARGET ${TARGET} PROPERTY INSTALL_RPATH_USE_LINK_PATH FALSE)
endfunction()
